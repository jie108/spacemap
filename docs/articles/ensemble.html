<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Boostrap Ensemble Network • spacemap</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">spacemap</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../installation.html">Installation</a>
</li>
<li>
  <a href="../reference/index.html">Docs</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basics.html">Model Fitting Basics</a>
    </li>
    <li>
      <a href="../articles/tuning.html">Model Tuning</a>
    </li>
    <li>
      <a href="../articles/ensemble.html">Ensemble Network</a>
    </li>
    <li>
      <a href="../articles/neta.html">Network Analysis Toolkit</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://topherconley.github.io/neta-bcpls/">Application</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/topherconley/spacemap">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Boostrap Ensemble Network</h1>
                        <h4 class="author">Christopher Conley, Pei Wang, Jie Peng</h4>
            
            <h4 class="date">2017-05-11</h4>
          </div>

    
    
<div class="contents">
<!--Bootstrap aggregation, or bagging, is known to be a powerful tool for stabilizing machine learning models (i.e. reducing the model variability) without incurring additional bias. Learning networks from data is related to classification, where ensemble methods like bagging were first employed^[Breiman, Leo (1996). "Bagging predictors". Machine Learning. 24 (2): 123–140. doi:10.1007/BF00058655.]. In this case, each potential edge must effectively be classified as no edge or edge. Bootstrap aggregation ought to increase the accuracy of the network structure when the model output varies dramatically after being subject to small perturbations to the data input. -->
<div id="purpose" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h2>
<p>Motivated by Bagging<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, we implemented the <code>Boot.Vote</code> procedure as an alternative to <code>CV.Vote</code> for the purpose of variance reduction and FDR control.</p>
<p>The <code>Boot.Vote</code> procedure fits the spaceMap model on <span class="math inline">\(B\)</span> bootstrapped re-samples of the data, which results in an ensemble of <span class="math inline">\(B\)</span> fitted networks. If an edge appears in the majority of these networks, then it is considered sufficiently reliable to be included in the final network. <!--While the voting component is similar to CV.Vote, Boot.Vote differs in the data sampling. In bootstrap re-sampling, the model is fit to $N$ samples drawn with replacement (i.e., any sample can be drawn more than once in a bootstrapped re-sample), while CV.Vote sub-samples without replacement depending on the number of hold out sets.--> In our experience,<code>Boot.Vote</code> often lowers the FDR at a small cost to the power compared to the <code>CV.vote</code> procedure. <!--However, Boot.Vote may not always be preferable to CV.Vote. The scope of this article is to demonstrate the application of Boot.Vote and leave it to the user to decide if Boot.Vote enhances the CV.Vote selected model depending on the nature of the application. --></p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This section contains a basic illustration on how to build an ensemble of networks for the spaceMap model through the <a href="https://topherconley.github.io/spacemap/reference/sim1.html">sim1</a> simulation data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(spacemap)
<span class="kw">data</span>(sim1)</code></pre></div>
<p>Model fitting is much faster if parallel computation is leveraged. If you choose to set up a parallel back-end (in this case for a multicore machine), it will use all available cores minus 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#if dopar==true, then model tuning done in parallel </span>
dopar &lt;-<span class="st"> </span><span class="ot">FALSE</span>
if (dopar) { 
  <span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(doParallel))
  <span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(parallel))
  ncores &lt;-<span class="st"> </span><span class="kw">detectCores</span>()  -<span class="st"> </span><span class="dv">1</span>
  cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(ncores)
  <span class="kw">registerDoParallel</span>(cl)
}</code></pre></div>
<p>Fit an ensemble of networks for the spaceMap model with 100 bootstrap replicates by the <a href="https://topherconley.github.io/spacemap/reference/bootEnsemble.html">bootEnsemble</a> and <a href="https://topherconley.github.io/spacemap/reference/bootVote.html">bootVote</a> functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#define tune penalty parameters</span>
tune &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">lam1 =</span> <span class="dv">73</span>, <span class="dt">lam2 =</span> <span class="dv">31</span>, <span class="dt">lam3 =</span> <span class="fl">20.5</span>)
smapens &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootEnsemble.html">bootEnsemble</a></span>(<span class="dt">Y =</span> sim1$Y, <span class="dt">X =</span> sim1$X, <span class="dt">tune =</span> tune,
                    <span class="dt">method =</span> <span class="st">"spacemap"</span>, <span class="dt">B =</span> <span class="dv">100</span>)
smapbv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootVote.html">bootVote</a></span>(smapens)</code></pre></div>
<p>The final network is stored as a list of two adjacency matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(smapbv$bv)</code></pre></div>
<pre><code>## List of 2
##  $ yy: num [1:171, 1:171] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : NULL
##   .. ..$ : NULL
##  $ xy: num [1:14, 1:171] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : NULL
##   .. ..$ : NULL</code></pre>
<!--
### SPACE 

Fit an ensemble network for the SPACE model (i.e. `method="space"`) with 100 bootstrap replicates.


```r
sens <- bootEnsemble(Y = sim1$Y, tune = list(lam1 = 70), 
                    method = "space", B = 100)
spacebv <- bootVote(sens)
```


Below the ensemble network is stored as an adjacency matrix . 


```r
str(spacebv$bv$yy)
```

```
##  num [1:171, 1:171] 0 0 0 0 0 0 0 0 0 0 ...
##  - attr(*, "dimnames")=List of 2
##   ..$ : NULL
##   ..$ : NULL
```



-->
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Breiman, Leo (1996). “Bagging predictors”. Machine Learning. 24 (2): 123–140. <a href="doi:10.1007/BF00058655" class="uri">doi:10.1007/BF00058655</a>.<a href="#fnref1">↩</a></p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#purpose">Purpose</a></li>
      <li><a href="#example">Example</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/topherconley/">Christopher Conley</a>, <a href="http://research.mssm.edu/wanglab/index.htm">Pei Wang</a>, <a href="http://www.stat.ucdavis.edu/~jie/">Jie Peng</a>, UC Davis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
